# Numa 需求文档

## 核心目标

Numa 的核心目标是自动完成需求，从需求分析到部署的整个 DevOps 流程。

## 核心能力需求

1. **需求理解**：
   - 能够分析用户提供的自然语言需求。
   - 识别需求中的关键信息，如功能点、技术栈、部署要求等。

2. **方案设计**：
   - 根据需求自动生成开发方案，包括架构设计、模块划分、接口定义等。
   - 提供多种方案供用户选择，解释各方案的优缺点。

3. **编码实现**：
   - 自动生成代码，包括业务逻辑、配置文件、依赖管理等。
   - 代码需符合项目规范和最佳实践。

4. **测试方案**：
   - 设计测试用例和测试方案。
   - 自动化执行测试，包括单元测试、集成测试等。

5. **部署与运维**：
   - 自动生成部署脚本和配置。
   - 支持多种部署环境，如本地、云平台等。
   - 提供部署后的监控和日志分析。

## 用户交互设计

### 五个核心阶段

1. **需求接受流程**：
   - 用户通过 Web 页面、API 或命令行提交需求。
   - Numa 分析需求，识别关键信息。
   - Numa 与用户进行交互，澄清需求中的模糊点。
   - 用户确认需求，Numa 生成需求文档。

2. **技术方案设计阶段**：
   - Numa 根据需求自动生成多种可行的技术方案。
   - Numa 提供方案评估机制，解释各方案的优缺点。
   - Numa 将技术方案提交给用户 review。
   - 用户 review 方案，提出修改意见，Numa 根据反馈进行调整，直到用户确认方案。

3. **开发&验证阶段**：
   - Numa 将技术方案拆分为具体的开发任务。
   - Numa 自主完成代码开发，包括业务逻辑、配置文件、依赖管理等。
   - Numa 自动生成测试用例，执行测试，分析测试结果。
   - 用户确认开发任务完成，Numa 进入下一阶段。

4. **提交代码并部署**：
   - Numa 总结开发 log，将代码 push 到代码仓库。
   - Numa 生成部署脚本和配置。
   - Numa 在部署系统上发起部署，监控部署过程。
   - 用户确认部署完成，Numa 进入下一阶段。

5. **完成需求，通知需求发起人验收**：
   - Numa 通知需求发起人验收，提供验收文档和链接。
   - 用户进行验收，确认需求完成。
   - Numa 总结整个流程，记录经验教训，优化后续流程。

## 交互方式

### 1. Web 页面

**适用场景**：
- 适合非技术人员或需要图形化界面的用户。
- 适合需要详细交互和可视化反馈的场景。

**设计建议**：
- 需求输入页面：提供文本输入框、文件上传功能。
- 需求澄清页面：展示需求分析结果，提供交互式澄清功能。
- 方案设计页面：展示多种技术方案，支持方案对比和选择。
- 开发进度页面：实时展示开发进度，提供日志和状态反馈。
- 部署页面：展示部署状态，提供部署日志和监控信息。

### 2. API 接口

**适用场景**：
- 适合开发者或需要与其他系统集成的场景。
- 适合自动化流程和批处理任务。

**设计建议**：
- 需求提交接口：提供 RESTful API，支持 JSON 格式的需求输入。
- 需求澄清接口：提供交互式 API，支持问答和选项选择。
- 方案获取接口：返回多种技术方案，支持方案对比和选择。
- 开发进度查询接口：实时返回开发进度和状态。
- 部署接口：支持部署操作和状态查询。

### 3. 命令行界面 (CLI)

**适用场景**：
- 适合开发者或需要快速操作的场景。
- 适合脚本化和自动化任务。

**设计建议**：
- 需求提交命令：支持文本输入和文件输入。
- 需求澄清命令：支持交互式命令，通过问答方式澄清需求。
- 方案查看命令：展示多种技术方案，支持方案对比和选择。
- 开发进度查看命令：实时显示开发进度。
- 部署命令：支持部署操作。

## 已实现功能

### 需求管理模块

1. **需求创建与查看**
   - 用户可以通过Web界面、API或CLI创建和查看需求
   - 需求可与具体应用关联

2. **需求澄清流程**
   - 系统可自动生成澄清问题
   - 用户可回答问题以明确需求细节
   - 需求可被标记为已澄清状态

3. **需求确认与完成**
   - 需求经过澄清后可被确认
   - 需求完成后可被标记为已完成状态

4. **需求文档自动生成**
   - 系统可根据需求内容自动生成规范文档

5. **分支名称自动生成**
   - 系统可为每个需求自动生成唯一的Git分支名称

### 方案管理模块

1. **方案自动生成**
   - 系统可根据需求自动生成技术方案

2. **方案关联**
   - 方案与需求和应用建立关联关系

3. **方案澄清流程**
   - 方案可提出问题进行澄清

4. **方案变更**
   - 方案内容可以随时变更

5. **方案确认**
   - 方案确认后进入下一阶段（开发阶段）
   - 确认后自动生成开发任务

### 开发任务管理模块

1. **任务自动生成**
   - 方案确认后自动生成对应开发任务

2. **任务关联**
   - 开发任务与方案、需求和应用都有关联关系

3. **代码分支属性**
   - 开发任务包含代码分支信息，便于代码管理

### 部署管理模块

1. **部署创建与查看**
   - 用户可以创建和查看部署信息

2. **部署关联**
   - 部署与开发任务建立关联关系

### 应用管理模块

1. **应用创建与查看**
   - 用户可以创建和查看应用信息

2. **应用属性**
   - 应用包含Git仓库地址、所有者、应用ID等完整属性信息

### 问题管理模块

1. **问题创建与回答**
   - 可针对需求或方案创建问题并进行回答

2. **问题澄清标记**
   - 问题可以被标记为已澄清状态

### 事件日志模块

1. **事件记录**
   - 系统自动记录关键操作的事件日志

### 系统基础设施

1. **多端口服务**
   - 前端服务运行在7300端口
   - 后端服务运行在7301端口

2. **完整的关联关系**
   - 所有模块之间建立了正确的关联关系，便于追踪和管理

3. **CLI工具**
   - 提供命令行界面支持所有核心功能操作

4. **Web界面**
   - 提供基于React.js和Material-UI的响应式Web界面

5. **RESTful API**
   - 后端提供完整的API支持，为Web和CLI提供数据支持

## 总结

Numa 的交互流程分为五个核心阶段，支持多种交互方式，包括 Web 页面、API 接口和命令行界面。通过多通道支持，满足不同用户的需求。系统已经实现了从需求管理到部署管理的完整DevOps流程，各模块之间建立了正确的关联关系，为后续功能扩展和优化奠定了基础。